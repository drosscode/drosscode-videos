Please take a look on the following pseudo-code:

    boolean blocked[2];
    int turn;
    void P(int id) {
          while(true) {
                 blocked[id] = true;
                 while(turn != id) {
                        while(blocked[1-id])
                        /* do nothing */;
                        turn = id;
                 }
                 /* critical section */
                 blocked[id] = false;
                 /* remainder */
          }
    }
    void main() {
          blocked[0] = false;
          blocked[1] = false;
          turn = 0;
          parbegin(P(0), P(1)); //RUN P0 and P1 parallel
    }
I thought that a could implement a simple Mutual - Exclution solution using the code above. But it's not working. Has anyone got an idea why?

Any help would really be appreciated!
